<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculatrice</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="Image/jpg" href="img/logo.jpg">
</head>
<body>

    <div class="container d-flex flex-column justify-content-center align-items-center" style="min-height: 100vh;">
        <h1 class="mb-4 titre-calculatrice">Calculatrice</h1>
        <div id="root"></div>
    </div>
    
    <script type="text/babel">
        function Calculatrice() {
            const [nombreafficher, setNombreAfficher] = React.useState("");

            React.useEffect(() => {
                const toucheUtiliser = (e) => {
                    if (e.key === "Backspace") {
                        setNombreAfficher(nombreafficher.slice(0, -1));
                    } 
                    else if (e.key === "Enter") {
                        calculer();
                    } 
                    else if (e.key === "C" || e.key === "c") {
                        effacer();
                    } 
                    else if (/[0-9+\-*/.=]/.test(e.key)) {
                        ajouter(e.key);
                    }
                };

                window.addEventListener("keydown", toucheUtiliser);
                return () => window.removeEventListener("keydown", toucheUtiliser);
            }, [nombreafficher]);

            const ajouter = (valeur) => {
                setNombreAfficher(nombreafficher + valeur);
            };

            const effacer = () => {
                setNombreAfficher("");
            };

            const calculer = () => {
                try {
                    const resultat = eval(nombreafficher);
                    setNombreAfficher(String(resultat));
                } catch {
                    setNombreAfficher("Erreur");
                }
            };

            const boutons = [
                "7","8","9","/","C",
                "4","5","6","*","-",
                "1","2","3","+","=",
                "0","."
            ];

            const clickDeclancher = (val) => {
                if (val === "C") effacer();
                else if (val === "=") calculer();
                else ajouter(val);
            };

            return (
                <div className="calculatrice p-4 shadow-lg" style={{maxWidth: "500px", margin: "15% auto"}}>
                    <input 
                        type="text" 
                        className="form-control mb-4 text-end fs-2 py-3" 
                        value={nombreafficher} 
                        readOnly 
                    />
                    <div 
                        className="d-grid gap-3" 
                        style={{gridTemplateColumns: "repeat(5, 1fr)", display: "grid"}}
                    >
                        {boutons.map((b, i) => (
                            <button 
                                key={i} 
                                className={`btn btn-${b === "C" ? "danger" : b === "=" ? "success" : "secondary"} fs-2 py-3`} 
                                onClick={() => clickDeclancher(b)}
                            >
                                {b}
                            </button>
                        ))}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById("root"));
        root.render(<Calculatrice />);
    </script>

</body>
</html>
